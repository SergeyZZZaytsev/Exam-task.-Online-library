{% extends "master.html" %}

{% block body %}
  <h2>{{ mode|capitalize }}</h2>

  <form method="GET" action="{{ request.path }}" class="search-form">
    <input type="text" name="search" placeholder="Please enter author/director/publisher/, year or title..." value="{{ request.args.get('search', '') }}">
    <button type="submit" class="search-btn">Search</button>
  </form>

  {% if mode not in ["books", "magazines", "films"] %}
    <div class="instruction">
      <p>
        The <strong>Online Library Service</strong> allows you to search for books, magazines, and films.
        You can use the main search bar on this page or perform a search within the corresponding section (Books, Magazines, Films).
      </p>
      <p>
        The service also enables you to add and delete books, magazines, or films from the existing database:
      </p>
      <ul>
        <li>To add a book, magazine, or film, go to the corresponding section and fill out the form in the top right corner.</li>
        <li>To delete a book, magazine, or film, find the desired item in the corresponding section and click the <em>"Delete"</em> button.</li>
      </ul>
    </div>
  {% endif %}

  {% if mode == "books" %}
    <table>
      <tr><th>Title</th><th>Author</th><th>Year</th><th>Action</th></tr>
      {% for book in items %}
        <tr>
          <td>{{ book.title }}</td>
          <td>{{ book.author }}</td>
          <td>{{ book.year }}</td>
          <td>
            <form action="/delete_book/{{ book.id }}" method="GET" style="display:inline;">
              <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this book?')"> Delete </button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>

    <form action="/books" method="POST" class="add-form">
      <input name="title" placeholder="Title" required>
      <input name="author" placeholder="Author" required>
      <input type="number" name="year" placeholder="Year" required>
      <button type="submit">Add Book</button>
    </form>

  {% elif mode == "magazines" %}
    <table>
      <tr><th>Title</th><th>Issue</th><th>Publisher</th><th>Year</th><th>Action</th></tr>
      {% for magazine in items %}
        <tr>
          <td>{{ magazine.title }}</td>
          <td>{{ magazine.issue }}</td>
          <td>{{ magazine.publisher }}</td>
          <td>{{ magazine.year }}</td>
          <td>
            <form action="/delete_magazine/{{ magazine.id }}" method="GET" style="display:inline;">
              <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this magazine?')"> Delete </button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>

    <form action="/magazines" method="POST" class="add-form">
      <input name="title" placeholder="Title" required>
      <input name="issue" placeholder="Issue" required>
      <input name="publisher" placeholder="Publisher" required>
      <input type="number" name="year" placeholder="Year" required>
      <button type="submit">Add Magazine</button>
    </form>

  {% elif mode == "films" %}
    <table>
      <tr><th>Title</th><th>Director</th><th>Year</th><th>Genre</th><th>Action</th></tr>
      {% for film in items %}
        <tr>
          <td>{{ film.title }}</td>
          <td>{{ film.director }}</td>
          <td>{{ film.year }}</td>
          <td>{{ film.genre }}</td>
          <td>
            <form action="/delete_film/{{ film.id }}" method="GET" style="display:inline;">
              <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this film?')"> Delete </button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>

    <form action="/films" method="POST" class="add-form">
      <input name="title" placeholder="Title" required>
      <input name="director" placeholder="Director" required>
      <input type="number" name="year" placeholder="Year" required>
      <input name="genre" placeholder="Genre" required>
      <button type="submit">Add Film</button>
    </form>
  {% endif %}
{% endblock %}